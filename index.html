<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mini WMS — FIFO / FEFO (Frontend Only)</title>
<style>
  :root{--bg:#f6f7fb;--card:#fff;--muted:#6b7280;--accent:#0b5fff}
  body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#0f172a}
  .wrap{max-width:1100px;margin:28px auto;padding:20px}
  header{display:flex;align-items:center;justify-content:space-between;gap:16px}
  h1{margin:0;font-size:20px}
  .grid{display:grid;gap:14px}
  .cols-3{grid-template-columns:1fr 1fr 1fr}
  .card{background:var(--card);border-radius:10px;padding:14px;box-shadow:0 1px 3px rgba(2,6,23,0.06)}
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
  input, select, textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #e6e9ef;font-size:14px;box-sizing:border-box}
  button{background:var(--accent);color:white;border:0;padding:8px 10px;border-radius:7px;cursor:pointer}
  button.ghost{background:transparent;color:var(--accent);border:1px solid #dbe4ff}
  table{width:100%;border-collapse:collapse;font-size:13px}
  th,td{padding:8px;border-bottom:1px solid #f1f3f7;text-align:left}
  th{color:var(--muted);font-weight:600;font-size:12px}
  .muted{color:var(--muted);font-size:13px}
  .badge{display:inline-block;padding:3px 8px;border-radius:999px;background:#eef2ff;color:var(--accent);font-size:12px}
  .danger{background:#ffeef0;color:#b91c1c}
  .small{font-size:12px}
  pre{white-space:pre-wrap;background:#0b1220;color:#dbeafe;padding:10px;border-radius:6px;overflow:auto}
  .row{display:flex;gap:8px;align-items:center}
  .split{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .right{justify-self:end}
  .note{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>Mini WMS — FIFO / FEFO (Frontend-only)</h1>
      <div class="muted small">Data stored locally in browser (localStorage). Try receive → create order → pick (choose FIFO/FEFO).</div>
    </div>
    <div class="row">
      <button id="btnReset" class="ghost">Reset Demo Data</button>
      <button id="btnExport" title="Export inventory CSV">Export Inventory CSV</button>
    </div>
  </header>

  <main class="grid" style="margin-top:16px">
    <section class="card">
      <h3 style="margin:0 0 10px 0">Items & Locations (seed)</h3>
      <div class="split">
        <div>
          <label>Items (sku,name,trackExpiry,defaultPolicy)</label>
          <pre id="itemsPre"></pre>
        </div>
        <div>
          <label>Locations</label>
          <pre id="locPre"></pre>
        </div>
      </div>
      <div style="margin-top:10px" class="row">
        <button id="btnAddSample">Add Sample Item & Location</button>
        <div class="note">You can reset demo data anytime.</div>
      </div>
    </section>

    <section class="card cols-3 grid">
      <div>
        <h4 style="margin:0 0 10px 0">Receive (GRN)</h4>
        <label>SKU</label>
        <input id="recv_sku" placeholder="e.g. SKU-2001" />
        <label>Qty</label>
        <input id="recv_qty" type="number" value="10" />
        <label>Batch / Lot (optional)</label>
        <input id="recv_batch" placeholder="BATCH-001" />
        <label>Expiry (optional)</label>
        <input id="recv_expiry" type="date" />
        <label>Location</label>
        <select id="recv_loc"></select>
        <div style="margin-top:10px" class="row">
          <button id="btnReceive">Receive to Stock</button>
          <button id="btnReceiveMany" class="ghost">Seed few lots</button>
        </div>
      </div>

      <div>
        <h4 style="margin:0 0 10px 0">Inventory (lots)</h4>
        <div class="muted small">Shows per-lot quantities and expiry.</div>
        <div style="margin-top:8px;max-height:260px;overflow:auto">
          <table id="tblInventory"><thead><tr><th>SKU</th><th>Batch</th><th>Loc</th><th>Qty</th><th>Received</th><th>Expiry</th><th>Status</th></tr></thead><tbody></tbody></table>
        </div>
      </div>

      <div>
        <h4 style="margin:0 0 10px 0">Simple Stock Journal (raw)</h4>
        <div style="max-height:260px;overflow:auto">
          <pre id="journalPre"></pre>
        </div>
      </div>
    </section>

    <section class="card">
      <h3 style="margin:0 0 10px 0">Orders & Picking</h3>
      <div class="split">
        <div>
          <label>Order No</label>
          <input id="order_no" placeholder="SO-0001" />
          <label>Lines (one per line: SKU:QTY)</label>
          <textarea id="order_lines" rows="4" placeholder="SKU-2001:5&#10;SKU-1001:2"></textarea>
          <div style="margin-top:8px" class="row">
            <button id="btnCreateOrder">Create Order</button>
            <div class="note">After create, use the Allocate/Pick area below.</div>
          </div>
        </div>

        <div>
